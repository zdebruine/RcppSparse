<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Documentation • RcppSparse</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Documentation">
<meta property="og:description" content="RcppSparse">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RcppSparse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Documentation.html">Documentation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Documentation_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Documentation</h1>
            
      
      
      <div class="hidden name"><code>Documentation.Rmd</code></div>

    </div>

    
    
<div id="why-rcppsparsematrix" class="section level2">
<h2 class="hasAnchor">
<a href="#why-rcppsparsematrix" class="anchor"></a>Why <code>RcppSparse::Matrix</code>?</h2>
<p>Accessing R sparse matrix objects in C++ via RcppArmadillo and RcppEigen requires <em>deep copies</em> because R SEXP types must be converted to C++ types. However, the Rcpp package provides base objects (<code>Rcpp::NumericVector</code> and <code>Rcpp::IntegerVector</code>) that are convenient containers around R objects existing in memory. <code><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html">RcppSparse::Matrix</a></code> simply wraps these containers to provide a zero-copy by-reference class for reading R sparse matrix objects in C++.</p>
<p>Unlike RcppArmadillo and RcppEigen, RcppSparse wastes no time or memory in the R to C++ to R conversion process.</p>
<p><strong>When to use:</strong> When only read access is needed and additional functionality in RcppArmadillo or RcppEigen is not needed.</p>
<p><strong>When not to use:</strong> When memory or R -&gt; C++ -&gt; R conversion is not limiting or write access is needed.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install <code>RcppSparse</code> from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"RcppSparse"</span><span class="op">)</span></code></pre></div>
<p>Include the header in your C++ file using <code>#include &lt;RcppSparse.h&gt;</code>. It is then unnecessary to include <code>Rcpp.h</code>, and <code>Rcpp.h</code> may not be included prior to including <code>RcppSparse.h</code>.</p>
</div>
<div id="sparse-matrix-class" class="section level2">
<h2 class="hasAnchor">
<a href="#sparse-matrix-class" class="anchor"></a>Sparse Matrix Class</h2>
<p>The <code>Matrix</code> class contains public members corresponding exactly to the <code>Matrix::dgCMatrix-class</code>:</p>
<ul>
<li>
<code>x</code>: An <code>Rcpp::NumericVector</code> of the non-zero elements of the matrix.</li>
<li>
<code>i</code>: An <code>Rcpp::IntegerVector</code> of the same length as <code>x</code> specifying the column indices of the non-zero elements of the matrix.</li>
<li>
<code>p</code>: An <code>Rcpp::IntegerVector</code> of pointers for each column to the initial index in <code>i</code> and <code>x</code> of elements in the column.</li>
<li>
<code>Dim</code>: An <code>Rcpp::IntegerVector</code> of length 2 giving the number of rows and columns in the matrix.</li>
</ul>
<p>Any object of class <code>Matrix::dgCMatrix</code> can be automatically converted to an Rcpp object of class <code><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html">RcppSparse::Matrix</a></code>.</p>
<p>However, to convert back to an R object, we use the <code>.wrap()</code> method and return an <code>Rcpp::S4</code> object.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">//[[Rcpp::export]]</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>Rcpp::S4 convert(RcppSparse::Matrix&amp; A){</span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="cf">return</span> A.wrap();</span>
<span id="cb2-4"><a href="#cb2-4"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://Matrix.R-forge.R-project.org/">Matrix</a></span><span class="op">)</span>
<span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/rsparsematrix.html">rsparsematrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">10</span>, ncol <span class="op">=</span> <span class="fl">10</span>, density <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="va">B</span> <span class="op">&lt;-</span> <span class="fu">convert</span><span class="op">(</span><span class="va">A</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">B</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>It is not necessary to specify <code>const</code> when passing an <code><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html">RcppSparse::Matrix</a></code> because it is read-only. Also, because base Rcpp types are pointers, it is unnecessary to pass by reference.</p>
<p>Because <code><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html">RcppSparse::Matrix</a></code> is a zero-copy by-reference read-only version of the R object, it is not templated and types are always double (<code>x</code>) and integer (<code>i</code>, <code>p</code>, <code>x</code>).</p>
</div>
<div id="constructors" class="section level2">
<h2 class="hasAnchor">
<a href="#constructors" class="anchor"></a>Constructors</h2>
<ul>
<li>
<code><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html">Matrix(SEXP)</a></code> (usually handled by <code>Rcpp::as</code>)</li>
<li><code><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html">Matrix(Rcpp::S4)</a></code></li>
<li><code><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html">Matrix()</a></code></li>
<li><code>Matrix(Rcpp::NumericVector x, Rcpp::IntegerVector i, Rcpp::IntegerVector p, Rcpp::IntegerVector Dim)</code></li>
</ul>
<p>Most commonly, the matrix is seamlessly passed into an Rcpp function from R, and <code>RcppSparse</code> takes care of the conversion (with some help from <code>Rcpp</code>).</p>
<p>However, <code>Matrix</code> may also be constructed from Rcpp vectors:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">//[[Rcpp::export]]</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>Rcpp::S4 construct_from_vectors(){</span>
<span id="cb4-3"><a href="#cb4-3"></a>    Rcpp::NumericVector x = {<span class="fl">0.41</span>, <span class="fl">0.35</span>, <span class="fl">0.84</span>, <span class="fl">0.37</span>, <span class="fl">0.26</span>};</span>
<span id="cb4-4"><a href="#cb4-4"></a>    Rcpp::IntegerVector i = {<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>};</span>
<span id="cb4-5"><a href="#cb4-5"></a>    Rcpp::IntegerVector p = {<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>};</span>
<span id="cb4-6"><a href="#cb4-6"></a>    Rcpp::IntegerVector Dim = {<span class="dv">5</span>, <span class="dv">5</span>};</span>
<span id="cb4-7"><a href="#cb4-7"></a>    </span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="co">// this constructor...</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>    RcppSparse::Matrix m(x, i, p, Dim);</span>
<span id="cb4-10"><a href="#cb4-10"></a>    </span>
<span id="cb4-11"><a href="#cb4-11"></a>    <span class="co">// ... is equivalent to this:</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>    RcppSparse::Matrix m2;</span>
<span id="cb4-13"><a href="#cb4-13"></a>    m2.x = x;</span>
<span id="cb4-14"><a href="#cb4-14"></a>    m2.i = i;</span>
<span id="cb4-15"><a href="#cb4-15"></a>    m2.p = p;</span>
<span id="cb4-16"><a href="#cb4-16"></a>    m2.Dim = Dim;</span>
<span id="cb4-17"><a href="#cb4-17"></a>    </span>
<span id="cb4-18"><a href="#cb4-18"></a>    <span class="cf">return</span> m2.wrap();</span>
<span id="cb4-19"><a href="#cb4-19"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">construct_from_vectors</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; 5 x 5 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;                           </span>
<span class="co">#&gt; [1,] . 0.41 .    0.84 .   </span>
<span class="co">#&gt; [2,] . .    .    0.37 0.26</span>
<span class="co">#&gt; [3,] . .    0.35 .    .   </span>
<span class="co">#&gt; [4,] . .    .    .    .   </span>
<span class="co">#&gt; [5,] . .    .    .    .</span></code></pre></div>
<p>Because each slot in a <code>Matrix</code> is a public member, they may also be directly modified with the caveat that R S4 object and/or iterators may be invalidated (very bad things can happen) if you do not really know what you are doing.</p>
</div>
<div id="member-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#member-functions" class="anchor"></a>Member functions</h2>
<p><code><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html">RcppSparse::Matrix</a></code> objects contain the following member functions:</p>
<ul>
<li>
<code>.rows()</code>, <code>.nrow()</code>
</li>
<li>
<code>.cols()</code>, <code>.ncol()</code>
</li>
<li>`.n_nonzero(): number of nonzeros in the matrix</li>
<li>
<code>.nonzeros()</code>: return the <code>x</code> vector</li>
<li>
<code>.innerIndexPtr()</code>: return the <code>i</code> vector</li>
<li>
<code>.outerIndexPtr()</code>: return the <code>p</code> vector</li>
<li><code>.crossprod()</code></li>
<li>
<code><a href="https://rdrr.io/r/base/colSums.html">.colSums()</a></code>, <code><a href="https://rdrr.io/r/base/colSums.html">.rowSums()</a></code>, <code><a href="https://rdrr.io/r/base/colSums.html">.colMeans()</a></code>, <code><a href="https://rdrr.io/r/base/colSums.html">.rowMeans()</a></code>
</li>
<li>
<code>.t()</code> (wraps <code>Matrix::t</code> method for <code>dgCMatrix</code>)</li>
<li>
<code>.InnerIndices(int col)</code>: return <code>std::vector&lt;unsigned int&gt;</code> of rows with non-zero values in a column</li>
<li>
<code>.emptyInnerIndices(int col)</code>: return <code>std::vector&lt;unsigned int&gt;</code> of rows with zero values in a column</li>
<li>
<code>.isAppxSymmetric()</code>: checks approximately for symmetry by checking for square dimensions and then by comparing the first row/column</li>
</ul>
</div>
<div id="dense-element-access" class="section level2">
<h2 class="hasAnchor">
<a href="#dense-element-access" class="anchor"></a>Dense element access</h2>
<p><code><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html">RcppSparse::Matrix</a></code> is read-only. However, the values of elements may be accessed using the parenthesis operator:</p>
<ul>
<li>
<code>double Matrix[int n]</code> return the n’th nonzero value</li>
<li><code>double Matrix(int row, int col)</code></li>
<li><code>Rcpp::NumericVector Matrix(Rcpp::IntegerVector row, int col)</code></li>
<li><code>Rcpp::NumericVector Matrix(int row, Rcpp::IntegerVector col)</code></li>
<li><code>Rcpp::NumericMatrix Matrix(Rcpp::IntegerVector row, Rcpp::IntegerVector col)</code></li>
</ul>
<p>There are no specializations for block lookup, thus, complicated lookups using the parenthesis operator can quickly become inefficient and iterators should be preferred.</p>
<p>Marginal dense subsets are also supported, although these may be better accessed via sparse iterators:</p>
<ul>
<li><code>Rcpp::NumericVector Matrix.col(int i)</code></li>
<li><code>Rcpp::NumericMatrix Matrix.col(Rcpp::IntegerVector i)</code></li>
<li><code>Rcpp::NumericVector Matrix.row(int i)</code></li>
<li><code>Rcpp::NumericMatrix Matrix.row(Rcpp::IntegerVector i)</code></li>
</ul>
</div>
<div id="sparse-iterators" class="section level2">
<h2 class="hasAnchor">
<a href="#sparse-iterators" class="anchor"></a>Sparse Iterators</h2>
<p>The major focus of the <code><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html">RcppSparse::Matrix</a></code> class is providing efficient const iterators for traversal over non-zero values.</p>
<ul>
<li>
<code>::InnerIterator</code>: Non-zeros in a column</li>
<li>
<code>::InnerRowIterator</code>: Non-zeros in a row (inefficient, prefer <code>InnerIterator</code>)</li>
<li>
<code>::InnerIteratorInRange</code>: Non-zeros in a column at rows also in a provided index vector</li>
<li>
<code>::InnerIteratorNotInRange</code>: Non-zeros in a column at rows that are not in a provided index vector</li>
</ul>
<p>Constructors:</p>
<ul>
<li>
<code>it(RcppSparse::Matrix, int)</code> constructor for <code>InnerIterator</code> and <code>InnerRowIterator</code>
</li>
<li>
<code>it(RcppSparse::Matrix, int, std::vector&lt;unsigned int&gt;)</code> constructor for <code>InnerIteratorInRange</code> and <code>InnerIteratorNotInRange</code>
</li>
</ul>
<p>Operators:</p>
<ul>
<li>
<code>operator bool()</code> to check if the iterator is in the range</li>
<li>
<code>++it</code>, pre-increment</li>
</ul>
<p>Member functions:</p>
<ul>
<li>
<code>it.value()</code>, const double reference to value</li>
<li>
<code>it.row()</code>, const int giving row of current value</li>
<li>
<code>it.col()</code>, const int giving column of current value</li>
</ul>
<div id="column-and-row-iterator" class="section level3">
<h3 class="hasAnchor">
<a href="#column-and-row-iterator" class="anchor"></a>Column and Row Iterator</h3>
<p>This example uses a column iterator to calculate column sums:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">//[[Rcpp::export]]</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>Rcpp::NumericVector column_sums(RcppSparse::Matrix&amp; A) {</span>
<span id="cb6-3"><a href="#cb6-3"></a>    Rcpp::NumericVector sums(A.cols());</span>
<span id="cb6-4"><a href="#cb6-4"></a>    <span class="cf">for</span> (<span class="dt">size_t</span> col = <span class="dv">0</span>; col &lt; A.cols(); ++col)</span>
<span id="cb6-5"><a href="#cb6-5"></a>        <span class="cf">for</span> (RcppSparse::Matrix::InnerIterator it(A, col); it; ++it)</span>
<span id="cb6-6"><a href="#cb6-6"></a>            sums(col) += it.value();</span>
<span id="cb6-7"><a href="#cb6-7"></a>    <span class="cf">return</span> sums;</span>
<span id="cb6-8"><a href="#cb6-8"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/rsparsematrix.html">rsparsematrix</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">0.5</span><span class="op">)</span>
<span class="fu">column_sums</span><span class="op">(</span><span class="va">A</span><span class="op">)</span>
<span class="co">#&gt; [1] -1.990  0.373 -0.530  0.498  0.330</span></code></pre></div>
<p>Usage of the row iterator is similar, but should not be used unless absolutely necessary as row-wise lookup in a column-major storage format is much less efficient than column-wise lookup.</p>
<p>The <code>InnerIteratorInRange</code> iterator receives a <code>std::vector&lt;unsigned int&gt;</code> giving row indices in a range over which to iterate. This is similar to the Boost ForwardTraversalIterator concept. This iterator can be useful for comparing two sparse matrices, and can be more efficient than simply pairing two iterators. <code>InnerIteratorNotInRange</code> usage is similar, but looks up values not in the specified range.</p>
</div>
</div>
<div id="reference-vs--copy" class="section level2">
<h2 class="hasAnchor">
<a href="#reference-vs--copy" class="anchor"></a>Reference vs. Copy</h2>
<p>Like Rcpp objects, <code><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html">RcppSparse::Matrix</a></code> is a reference to R objects. Any changes to object on the C++ side will affect the R object. If this is not desired, use <code>.clone()</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1"></a><span class="co">//[[Rcpp::export]]</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>Rcpp::S4 change_value1(RcppSparse::Matrix A){</span>
<span id="cb8-3"><a href="#cb8-3"></a>    RcppSparse::Matrix B = A.clone();</span>
<span id="cb8-4"><a href="#cb8-4"></a>    B.x[<span class="dv">0</span>] = <span class="dv">999</span>;</span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="cf">return</span> B.wrap();</span>
<span id="cb8-6"><a href="#cb8-6"></a>}</span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">//[[Rcpp::export]]</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="dt">void</span> change_value2(RcppSparse::Matrix A){</span>
<span id="cb8-10"><a href="#cb8-10"></a>    A.x[<span class="dv">0</span>] = <span class="dv">999</span>;</span>
<span id="cb8-11"><a href="#cb8-11"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/rsparsematrix.html">rsparsematrix</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">0.5</span><span class="op">)</span>
<span class="va">A2</span> <span class="op">&lt;-</span> <span class="fu">change_value1</span><span class="op">(</span><span class="va">A</span><span class="op">)</span>
<span class="va">A2</span><span class="op">@</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; [1] 999</span>
<span class="va">A</span><span class="op">@</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; [1] -1.5</span>
<span class="fu">change_value2</span><span class="op">(</span><span class="va">A</span><span class="op">)</span>
<span class="va">A</span><span class="op">@</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; [1] 999</span></code></pre></div>
</div>
<div id="benchmarks" class="section level2">
<h2 class="hasAnchor">
<a href="#benchmarks" class="anchor"></a>Benchmarks</h2>
<p>The following are very rudimentary benchmarks that are intended to show that <code><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html">RcppSparse::Matrix</a></code> is on par with <code>arma::sp_mat</code> and <code>Eigen::SparseMatrix</code>. Although evidence here is limited, further application has shown that performance is very much on par both libraries, and consistently exceeds that of the <code>Matrix</code> R package in equivalent operations.</p>
<div id="constructor-latency" class="section level3">
<h3 class="hasAnchor">
<a href="#constructor-latency" class="anchor"></a>Constructor Latency</h3>
<p>Here we measure the latency of constructing a 1% dense 10000 x 10000 sparse dgCMatrix in <code><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html">RcppSparse::Matrix</a></code>, <code>arma::sp_mat</code>, and <code>Eigen::SparseMatrix&lt;double&gt;</code>:</p>
<p><img src="Documentation_files/figure-html/unnamed-chunk-15-1.png" width="384"></p>
<p>This benchmark shows how important direct access to R objects in memory can be when performance and memory usage is a major concern.</p>
</div>
<div id="iterator-performance" class="section level3">
<h3 class="hasAnchor">
<a href="#iterator-performance" class="anchor"></a>Iterator Performance</h3>
<p>Here we compare the performance of <code><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html">RcppSparse::Matrix</a></code> column iterator to corresponding counterparts in RcppEigen and RcppArmadillo. We use the RcppClock R package for benchmarking the Rcpp code itself to avoid the effects of latency during the Rcpp wrap and as routines. 10 outer and inner replicates are run:</p>
<p><img src="Documentation_files/figure-html/unnamed-chunk-17-1.png" width="384"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Zach DeBruine.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
